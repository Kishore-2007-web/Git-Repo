<!doctype htmll>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solar System Explorer</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
    }

    body {
      font-family: 'Space Grotesk', 'Orbitron', monospace;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1429 100%);
      color: #e8eaf6;
      overflow: hidden;
    }

    .app-container {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden;
    }

    .header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 24px 32px;
      background: linear-gradient(180deg, rgba(10, 14, 39, 0.95) 0%, rgba(10, 14, 39, 0) 100%);
      z-index: 100;
    }

    .title {
      font-size: 32px;
      font-weight: 700;
      letter-spacing: 2px;
      color: #00d4ff;
      text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
    }

    .canvas-container {
      width: 100%;
      height: 100%;
      position: relative;
      cursor: grab;
    }

    .canvas-container:active {
      cursor: grabbing;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }

    .info-panel {
      position: absolute;
      top: 100px;
      right: 32px;
      width: 320px;
      background: rgba(15, 20, 41, 0.95);
      border: 2px solid #00d4ff;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 8px 32px rgba(0, 212, 255, 0.3);   
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      z-index: 90;
      max-height: calc(100% - 140px);
      overflow-y: auto;
    }

    .info-title {
      font-size: 22px;
      font-weight: 700;
      color: #00d4ff;
      margin-bottom: 16px;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
    }

    .info-item {
      margin-bottom: 14px;
      line-height: 1.6;
    }

    .info-label {
      font-weight: 600;
      color: #64b5f6;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .info-value {
      color: #e8eaf6;
      font-size: 15px;
      margin-top: 4px;
    }

    .controls-panel {
      position: absolute;
      bottom: 32px;
      left: 32px;
      background: rgba(15, 20, 41, 0.95);
      border: 2px solid #00d4ff;
      border-radius: 12px;
      padding: 20px 24px;
      box-shadow: 0 8px 32px rgba(0, 212, 255, 0.3);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      z-index: 90;
    }

    .controls-title {
      font-size: 16px;
      font-weight: 700;
      color: #00d4ff;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }

    .control-item {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      font-size: 13px;
      color: #b0bec5;
    }

    .control-key {
      display: inline-block;
      background: rgba(100, 181, 246, 0.2);
      padding: 4px 10px;
      border-radius: 4px;
      margin-right: 12px;
      font-weight: 600;
      color: #64b5f6;
      min-width: 100px;
    }

    .speed-control {
      position: absolute;
      bottom: 32px;
      right: 32px;
      background: rgba(15, 20, 41, 0.95);
      border: 2px solid #00d4ff;
      border-radius: 12px;
      padding: 16px 20px;
      box-shadow: 0 8px 32px rgba(0, 212, 255, 0.3);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      z-index: 90;
    }

    .speed-label {
      font-size: 13px;
      color: #64b5f6;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .speed-buttons {
      display: flex;
      gap: 8px;
    }

    .speed-btn {
      padding: 8px 16px;
      background: rgba(100, 181, 246, 0.2);
      border: 1px solid #64b5f6;
      border-radius: 6px;
      color: #64b5f6;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .speed-btn:hover {
      background: rgba(100, 181, 246, 0.3);
      transform: translateY(-2px);
    }

    .speed-btn.active {
      background: #00d4ff;
      color: #0a0e27;
      border-color: #00d4ff;
    }

    .celestial-label {
      position: absolute;
      font-size: 12px;
      color: #e8eaf6;
      background: rgba(0, 212, 255, 0.2);
      padding: 4px 8px;
      border-radius: 4px;
      pointer-events: none;
      z-index: 50;
      transform: translate(-50%, -50%);
      white-space: nowrap;
      border: 1px solid rgba(0, 212, 255, 0.5);
    }

    .orbit-path {
      stroke: rgba(100, 181, 246, 0.3);
      stroke-width: 1;
      fill: none;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .sun-glow {
      animation: pulse 4s ease-in-out infinite;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <div class="header">
    <div class="title" id="appTitle">
     Solar System Explorer
    </div>
   </div>
   <div class="canvas-container" id="canvasContainer">
    <canvas id="spaceCanvas"></canvas>
   </div>
   <div class="info-panel">
    <div class="info-title" id="infoPanelTitle">
     About This Celestial Body
    </div>
    <div id="infoContent"></div>
   </div>
   <div class="controls-panel">
    <div class="controls-title" id="controlsLabel">
     Navigation Controls
    </div>
    <div class="control-item"><span class="control-key">Drag Mouse</span> <span>Rotate view</span>
    </div>
    <div class="control-item"><span class="control-key">Scroll Wheel</span> <span>Zoom in/out</span>
    </div>
    <div class="control-item"><span class="control-key">Click Body</span> <span>View details</span>
    </div>
   </div>
   <div class="speed-control">
    <div class="speed-label">
     Orbit Speed
    </div>
    <div class="speed-buttons"><button class="speed-btn" data-speed="0.5">0.5x</button> <button class="speed-btn active" data-speed="1">1x</button> <button class="speed-btn" data-speed="2">2x</button> <button class="speed-btn" data-speed="5">5x</button>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      app_title: "Solar System Explorer",
      info_panel_title: "About This Celestial Body",
      controls_label: "Navigation Controls",
      background_color: "#0a0e27",
      accent_color: "#00d4ff",
      text_color: "#e8eaf6",
      secondary_color: "#64b5f6",
      panel_color: "#0f1429",
      font_family: "Space Grotesk",
      font_size: 16
    };

    const canvas = document.getElementById('spaceCanvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    let animationId;

    function resizeCanvas() {
      const container = document.getElementById('canvasContainer');
      width = container.clientWidth;
      height = container.clientHeight;
      canvas.width = width;
      canvas.height = height;
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Camera controls
    let camera = {
      x: 0,
      y: 0,
      zoom: 1,
      rotation: 0,
      isDragging: false,
      lastX: 0,
      lastY: 0
    };

    // Celestial bodies data
    const bodies = {
      sun: {
        name: 'Sun',
        radius: 30,
        color: '#FDB813',
        x: 0,
        y: 0,
        mass: 1000,
        info: {
          type: 'Star',
          diameter: '1,392,700 km',
          temperature: '5,778 K (surface)',
          composition: '73% Hydrogen, 25% Helium',
          fact: 'The Sun contains 99.86% of the mass in our solar system'
        }
      },
      earth: {
        name: 'Earth',
        radius: 12,
        color: '#4A90E2',
        orbitRadius: 200,
        orbitSpeed: 0.02,
        angle: 0,
        x: 0,
        y: 0,
        mass: 10,
        info: {
          type: 'Rocky Planet',
          diameter: '12,742 km',
          distance: '149.6 million km from Sun',
          orbital_period: '365.25 days',
          fact: 'Only known planet with liquid water and life'
        }
      },
      moon: {
        name: 'Moon',
        radius: 4,
        color: '#C0C0C0',
        orbitRadius: 30,
        orbitSpeed: 0.08,
        angle: 0,
        parent: 'earth',
        x: 0,
        y: 0,
        mass: 1,
        info: {
          type: 'Natural Satellite',
          diameter: '3,474 km',
          distance: '384,400 km from Earth',
          orbital_period: '27.3 days',
          fact: 'The Moon is slowly drifting away from Earth at 3.8 cm per year'
        }
      },
      mars: {
        name: 'Mars',
        radius: 10,
        color: '#E27B58',
        orbitRadius: 300,
        orbitSpeed: 0.01,
        angle: Math.PI / 2,
        x: 0,
        y: 0,
        mass: 7,
        info: {
          type: 'Rocky Planet',
          diameter: '6,779 km',
          distance: '227.9 million km from Sun',
          orbital_period: '687 days',
          fact: 'Mars has the largest volcano in the solar system: Olympus Mons'
        }
      }
    };

    let orbitSpeed = 1;
    let selectedBody = null;

    // Mouse controls
    canvas.addEventListener('mousedown', (e) => {
      camera.isDragging = true;
      camera.lastX = e.clientX;
      camera.lastY = e.clientY;
    });

    canvas.addEventListener('mousemove', (e) => {
      if (camera.isDragging) {
        const dx = e.clientX - camera.lastX;
        const dy = e.clientY - camera.lastY;
        camera.x += dx;
        camera.y += dy;
        camera.lastX = e.clientX;
        camera.lastY = e.clientY;
      }
    });

    canvas.addEventListener('mouseup', () => {
      camera.isDragging = false;
    });

    canvas.addEventListener('wheel', (e) => {
      e.preventDefault();
      const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
      camera.zoom = Math.max(0.3, Math.min(3, camera.zoom * zoomFactor));
    });

    canvas.addEventListener('click', (e) => {
      if (camera.isDragging) return;
      
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;

      // Check if clicked on any body
      for (const key in bodies) {
        const body = bodies[key];
        const screenX = (body.x + camera.x) * camera.zoom + width / 2;
        const screenY = (body.y + camera.y) * camera.zoom + height / 2;
        const distance = Math.sqrt(Math.pow(mouseX - screenX, 2) + Math.pow(mouseY - screenY, 2));
        
        if (distance < body.radius * camera.zoom) {
          selectedBody = key;
          updateInfoPanel();
          break;
        }
      }
    });

    // Speed control buttons
    document.querySelectorAll('.speed-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.speed-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        orbitSpeed = parseFloat(btn.dataset.speed);
      });
    });

    function updateInfoPanel() {
      const infoContent = document.getElementById('infoContent');
      if (!selectedBody || !bodies[selectedBody]) {
        infoContent.innerHTML = '<div class="info-value">Click on a celestial body to learn more about it!</div>';
        return;
      }

      const body = bodies[selectedBody];
      let html = `<div class="info-item">
        <div class="info-label">Name</div>
        <div class="info-value">${body.name}</div>
      </div>`;

      for (const [key, value] of Object.entries(body.info)) {
        const label = key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        html += `<div class="info-item">
          <div class="info-label">${label}</div>
          <div class="info-value">${value}</div>
        </div>`;
      }

      infoContent.innerHTML = html;
    }

    function drawOrbit(centerX, centerY, radius) {
      ctx.beginPath();
      ctx.arc(
        (centerX + camera.x) * camera.zoom + width / 2,
        (centerY + camera.y) * camera.zoom + height / 2,
        radius * camera.zoom,
        0,
        Math.PI * 2
      );
      ctx.strokeStyle = 'rgba(100, 181, 246, 0.3)';
      ctx.lineWidth = 1;
      ctx.stroke();
    }

    function drawBody(body, isSun = false) {
      const screenX = (body.x + camera.x) * camera.zoom + width / 2;
      const screenY = (body.y + camera.y) * camera.zoom + height / 2;
      const screenRadius = body.radius * camera.zoom;

      // Draw glow for sun
      if (isSun) {
        const gradient = ctx.createRadialGradient(screenX, screenY, 0, screenX, screenY, screenRadius * 2);
        gradient.addColorStop(0, 'rgba(253, 184, 19, 0.8)');
        gradient.addColorStop(0.5, 'rgba(253, 184, 19, 0.3)');
        gradient.addColorStop(1, 'rgba(253, 184, 19, 0)');
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(screenX, screenY, screenRadius * 2, 0, Math.PI * 2);
        ctx.fill();
      }

      // Draw body
      ctx.fillStyle = body.color;
      ctx.beginPath();
      ctx.arc(screenX, screenY, screenRadius, 0, Math.PI * 2);
      ctx.fill();

      // Highlight if selected
      if (selectedBody && bodies[selectedBody] === body) {
        ctx.strokeStyle = '#00d4ff';
        ctx.lineWidth = 3;
        ctx.stroke();
      }

      // Draw simple texture
      if (!isSun) {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
        ctx.beginPath();
        ctx.arc(screenX - screenRadius * 0.3, screenY - screenRadius * 0.3, screenRadius * 0.3, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function updatePositions() {
      // Update Earth
      bodies.earth.angle += bodies.earth.orbitSpeed * orbitSpeed;
      bodies.earth.x = Math.cos(bodies.earth.angle) * bodies.earth.orbitRadius;
      bodies.earth.y = Math.sin(bodies.earth.angle) * bodies.earth.orbitRadius;

      // Update Moon (relative to Earth)
      bodies.moon.angle += bodies.moon.orbitSpeed * orbitSpeed;
      bodies.moon.x = bodies.earth.x + Math.cos(bodies.moon.angle) * bodies.moon.orbitRadius;
      bodies.moon.y = bodies.earth.y + Math.sin(bodies.moon.angle) * bodies.moon.orbitRadius;

      // Update Mars
      bodies.mars.angle += bodies.mars.orbitSpeed * orbitSpeed;
      bodies.mars.x = Math.cos(bodies.mars.angle) * bodies.mars.orbitRadius;
      bodies.mars.y = Math.sin(bodies.mars.angle) * bodies.mars.orbitRadius;
    }

    function drawStars() {
      ctx.fillStyle = '#ffffff';
      for (let i = 0; i < 200; i++) {
        const x = (Math.sin(i * 123.456) * 10000) % width;
        const y = (Math.cos(i * 789.012) * 10000) % height;
        const size = Math.random() * 2;
        ctx.fillRect(x, y, size, size);
      }
    }

    function animate() {
      ctx.fillStyle = defaultConfig.background_color;
      ctx.fillRect(0, 0, width, height);

      drawStars();
      updatePositions();

      // Draw orbits
      drawOrbit(bodies.sun.x, bodies.sun.y, bodies.earth.orbitRadius);
      drawOrbit(bodies.earth.x, bodies.earth.y, bodies.moon.orbitRadius);
      drawOrbit(bodies.sun.x, bodies.sun.y, bodies.mars.orbitRadius);

      // Draw bodies
      drawBody(bodies.sun, true);
      drawBody(bodies.earth);
      drawBody(bodies.moon);
      drawBody(bodies.mars);

      animationId = requestAnimationFrame(animate);
    }

    // Initialize
    selectedBody = 'earth';
    updateInfoPanel();
    animate();

    // Element SDK integration
    async function onConfigChange(config) {
      const baseSize = config.font_size || defaultConfig.font_size;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'Orbitron, monospace';

      document.getElementById('appTitle').textContent = config.app_title || defaultConfig.app_title;
      document.getElementById('infoPanelTitle').textContent = config.info_panel_title || defaultConfig.info_panel_title;
      document.getElementById('controlsLabel').textContent = config.controls_label || defaultConfig.controls_label;

      // Apply colors
      const accentColor = config.accent_color || defaultConfig.accent_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const panelColor = config.panel_color || defaultConfig.panel_color;

      document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${panelColor} 50%, ${backgroundColor} 100%)`;
      document.body.style.color = textColor;

      document.querySelector('.title').style.color = accentColor;
      document.querySelector('.title').style.textShadow = `0 0 20px ${accentColor}80`;

      document.querySelectorAll('.info-panel, .controls-panel, .speed-control').forEach(el => {
        el.style.background = `${panelColor}f2`;
        el.style.borderColor = accentColor;
        el.style.boxShadow = `0 8px 32px ${accentColor}4d`;
      });

      document.querySelectorAll('.info-title, .controls-title').forEach(el => {
        el.style.color = accentColor;
        el.style.textShadow = `0 0 10px ${accentColor}80`;
      });

      document.querySelectorAll('.info-label, .speed-label, .control-key').forEach(el => {
        el.style.color = secondaryColor;
      });

      document.querySelectorAll('.speed-btn').forEach(btn => {
        btn.style.borderColor = secondaryColor;
        btn.style.color = secondaryColor;
        btn.style.background = `${secondaryColor}33`;
      });

      document.querySelector('.speed-btn.active').style.background = accentColor;
      document.querySelector('.speed-btn.active').style.color = backgroundColor;

      // Apply fonts
      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
      document.querySelector('.title').style.fontSize = `${baseSize * 2}px`;
      document.querySelector('.info-title').style.fontSize = `${baseSize * 1.375}px`;
      document.querySelectorAll('.info-label, .speed-label').forEach(el => {
        el.style.fontSize = `${baseSize * 0.8125}px`;
      });
      document.querySelectorAll('.info-value, .controls-title').forEach(el => {
        el.style.fontSize = `${baseSize * 0.9375}px`;
      });
      document.querySelectorAll('.control-item, .speed-btn').forEach(el => {
        el.style.fontSize = `${baseSize * 0.8125}px`;
      });
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.panel_color || defaultConfig.panel_color,
              set: (value) => {
                config.panel_color = value;
                window.elementSdk.setConfig({ panel_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.accent_color || defaultConfig.accent_color,
              set: (value) => {
                config.accent_color = value;
                window.elementSdk.setConfig({ accent_color: value });
              }
            },
            {
              get: () => config.secondary_color || defaultConfig.secondary_color,
              set: (value) => {
                config.secondary_color = value;
                window.elementSdk.setConfig({ secondary_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["app_title", config.app_title || defaultConfig.app_title],
          ["info_panel_title", config.info_panel_title || defaultConfig.info_panel_title],
          ["controls_label", config.controls_label || defaultConfig.controls_label]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c826909570285e8',t:'MTc3MDEyNjc2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>